Job <5657024> has been submitted to queue <q_sw_expr>
waiting for dispatch ...
[5657024 ## mn381: 6936 ## 2023-08-29/14:31:57] cnodenum= 11, job-resource-list: 21510-21520
[5657024 ## mn381: 6936 ## 2023-08-29/14:31:57] nodelist[0-9]=21510-21519, mpenum=6, mpemap=0x3f, spemap=<FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF>
[5657024 ## mn381: 6936 ## 2023-08-29/14:31:57] nodelist[10]=21520, mpenum=4, mpemaplist=0Xf, spemap=<00000000000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF>
[5657024 ## mn381: 6936 ## 2023-08-29/14:31:57] control node is: mn381.
[5657024 ## mn381: 6936 ## 2023-08-29/14:31:57] sub control node number is 1, list: mn026.
[5657024 ## vn021510: 8790 ## 2023-08-29/14:32:00] job's first task will run: /usr/bin/swrun -b 1 -K 1024 -s 5000 -m 1 -j 5657024 -F 0xFFFFFFFFFFFFFFFF -i ../../bin/ifos3d inv.json 
2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:155 |  
***********************************************************

 


***********************************************************
 This is program IFOS3D.          
 3D-Adjoint Full WAveform Inversion Tool      
 for 3D elastic FWI                                                         
 FWI code written by  S. Butzer        
 forward FD code  written by  T. Bohlen    
 Geophysical Institute, Department of Physics,         
 Institute of Technology, Karlsruhe, Germany         
 http://www.gpi.kit.edu 
 ***********************************************************

 
 Input parameter filename read from command line : inv.json. 

 From input file inv.json, 65 objects have been read in. 

 ===========================================================
 =   List of Parameters read by the built in Json Parser   =
 ===========================================================
 ||  Object # | object name 	| object value           ||
 ===========================================================
       1     |                DRX | 10 
       2     |                DRZ | 10 
       3     |           DAMPTYPE | 2 
       4     |                 FW | 10 
       5     |        SOURCE_TYPE | 4 
       6     |        SOURCE_FILE | input/sources.dat 
       7     |           TESTSTEP | 0.02 
       8     |               FILT | 1 
       9     | RUN_MULTIPLE_SHOTS | 1 
      10     |                 NX | 160 
      11     |                 NY | 184 
      12     |                 NZ | 160 
      13     |             EXTOBS | 0 
      14     |               TAST | 100 
      15     |             METHOD | 1 
      16     |           ABS_TYPE | 2 
      17     |             NPROCX | 2 
      18     |             NPROCY | 8 
      19     |             NPROCZ | 4 
      20     |                  L | 0 
      21     |              NFMAX | 5 
      22     |            DAMPING | 9.9 
      23     |              MFILE | model/toy 
      24     |                NDT | 1 
      25     |                VP0 | 6200.0 
      26     |                VS0 | 3600.0 
      27     |               RHO0 | 2800.0 
      28     |              ITMIN | 1 
      29     |              ITMAX | 60 
      30     |      SEIS_OBS_FILE | ./su_obs/obs 
      31     |             SEISMO | 1 
      32     |     REC_ARRAY_DIST | 30.0 
      33     |            FDCOEFF | 2 
      34     |       MOD_OUT_FILE | ./model/toy 
      35     |               SNAP | 0 
      36     |          REC_ARRAY | 1 
      37     |          JSON_FILE | inv.json 
      38     |             PREFIX | toy 
      39     |                 DZ | 0.8 
      40     |                 DX | 0.8 
      41     |                 DY | 0.8 
      42     |              LBFGS | 0 
      43     |             SAVESU | 0 
      44     |                 DT | 5.0e-05 
      45     |               HESS | 0 
      46     |             NPOWER | 1000.0 
      47     |       SOURCE_SHAPE | 4 
      48     |             GRADMO | 0 
      49     |            FDORDER | 4 
      50     |          FREE_SURF | 0 
      51     |    REC_ARRAY_DEPTH | 24.0 
      52     |          GRAD_FILE | ./grad/grad 
      53     |           LOG_FILE | inv.log 
      54     |          SEIS_FILE | ./su/cal 
      55     |            READMOD | 0 
      56     |          WEIGHT_VP | 1.0 
      57     |          WEIGHT_VS | 1.0 
      58     |         WEIGHT_RHO | 0.0 
      59     |        NSHOTS_STEP | 4 
      60     |             SRCREC | 1 
      61     |            READREC | 2 
      62     |           INV_FILE | input/workflow.dat 
      63     |               TIME | 0.06 
      64     |        SEIS_FORMAT | 1 
      65     |           BOUNDARY | 1 
 ========================================================

 The following default values are set:
 =====================================

 Variable REFSRCX is set to default value 0.0.
 Variable REFSRCY is set to default value 0.0.
 Variable REFSRCZ is set to default value 0.0.
Variable VERBOSE is set to value 1.
 Variable IDX is set to default value 1.
 Variable IDY is set to default value 1.
 Variable IDZ is set to default value 1.
 Variable REFREC is set to default value (0.0,0.0,0.0).
 Variable NDTSHIFT is set to default value 1.

 End of setting default values
 =====================================

 Please note: 
 Information about overall program execution 
 (numerical artefacts, accuracy, computing times etc) 
 will be written by PE 0 to  standard output. 
2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:211 |  This is the log-file generated by PE 0 



 **Message from initprocs (printed by PE 0):
 Size of subarrays in gridpoints:
 IENDX = 80
 IENDY (vertical) = 23
 IENDZ = 40

 Processor locations in the 3D logical processor array
 MYID 	 POS(1):left,right 	 POS(3): front, back 	 POS(2): top, bottom
 0 		 0: -1,1 		 0: -1,16 		 0: -1,2 

 **********************************************************
 ********* PARAMETERS AS SPECIFIED IN INPUT FILE **********
 **********************************************************



 **Message from write_par (printed by PE 0):

------------------------- Processors ------------------------
 Number of PEs in horizontal x-direction (NPROCX): 2
 Number of PEs in vertical   y-direction (NPROCY): 8
 Number of PEs in horizontal z-direction (NPROCZ): 4
 Total number of PEs in use: 64

 ----------------------- Discretization  ---------------------
 Number of gridpoints in x-direction (NX): 160
 Number of gridpoints in y-direction (NY): 184
 Number of gridpoints in z-direction (NZ): 160
 Grid-spacing in x-direction (DX): 8.000000e-01 meter
 Grid-spacing in y-direction (DY): 8.000000e-01 meter
 Grid-spacing in z-direction (DZ): 8.000000e-01 meter
 Time of wave propagation (T): 5.995000e-02 seconds
 Timestep (DT): 5.000000e-05 seconds
 Number of timesteps: 1200 

 ------------------------- ORDER OF FD OPERATORS --------------
 Order of FD operators: 4 

 ------------------------- SOURCE -----------------------------
 Reading source positions, time delay, centre frequency 
 and initial amplitude from ASCII-file input/sources.dat

 IFOS will run (independent) simulations for each source defined in input/sources.dat

 Wavelet of source: sinus raised to the power of 3.0 
 Default type of source: point source with directive force in  y-direction (vertical) 


 Source file: input/sources.dat 

 Multiple shots: 1 
 ------------------------- RECEIVER  ------- -------------------
 Horitontal plane of receivers.
 Number of planes: 1 
 Depth of upper plane: 2.400000e+01 m 
 Vertical increment between planes: 3.000000e+01 m 
 Distance between receivers in x-direction within plane: 10 Gridpoints
 Distance between receivers in z-direction within plane: 10 Gridpoints

 ------------------------- FREE SURFACE ------------------------
 There is no free surface at the top of the model ! 

 ------------------------- ABSORBING FRAME ---------------------
 Width of absorbing frame is 10 grid points.
 The percentage of amplitude decay at the edge is set to 9.900000 
 Periodic boundary condition at left/right and front/back sides of global grid.


 -----------------------  SEISMOGRAMS  ----------------------
 Seismograms of  x-, y-, and z-component of particle velocity.
 output-files: 
 	./su/cal_x.su
	./su/cal_y.su
	./su/cal_z.su
 Amplitudes will be written every 1st time-step, starting at the 1st.
 Seismograms are written in SU-format (output in meter, native endian and floats). 
 samplingrate of seismic data:                5.000000e-05 s
 Number of samples per receiver:              1200 
 Number of samples per trace:                 1200 
 ----------------------------------------------------------



 Inversion method: 1

 ----------------------- INVERSION PARAMETER  ----------------------
-------------------------In- and Output Files--------------------------------------
 
 Gradients are written to FILE:./grad/grad
 
 Models are written to FILE:./model/toy
 
 Observed Seismograms:./su_obs/obs

 External observed Seismograms: 0 
 
 Inversion FILE:input/workflow.dat
 
-------------------------General---------------------------------------------------
 
 minimum/maximum_iteration_number: 1,60
 
 filtering: 1
 
 maximum_number_frequencies_per_iteration: 5
 
 number_of_timestep_per_wavelength_used_for_inversion: 100
 
 average_model_parameter VP0=6200.00 m/s, VS0=3600.00 m/s, RHO0=2800.00 kg/m^3
 
 parameter_class_weighting_factors_for_vp:  1.00, vs:  1.00, rho:  0.00
 
------------------------Steplength estimation----------------------------------------

 number_of_shots_used_for_steplength_estimation: 4

 initial test steplength: 0.020000
 
------------------------Gradient preconditioning-------------------------------------
 
 Type_of_preconditioning:2

 **********************************************************
 ******* PARAMETERS READ or PROCESSED within IFOS3D ********
 **********************************************************

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:246 | 
 ------------------ READING RECEIVER PARAMETERS ----------------- 


 **Message from function receiver (written by PE 0):
 Number of receiver positions found: 289
 Receiver positions (in gridpoints) in the global model-system:
 x  	y 	z 
 -  	- 	- 
  0.00   24.00    0.00
  8.00   24.00    0.00
 16.00   24.00    0.00
 24.00   24.00    0.00
 32.00   24.00    0.00
 40.00   24.00    0.00
 48.00   24.00    0.00
 56.00   24.00    0.00
 64.00   24.00    0.00
 72.00   24.00    0.00
 80.00   24.00    0.00
 88.00   24.00    0.00
 96.00   24.00    0.00
 104.00   24.00    0.00
 112.00   24.00    0.00
 120.00   24.00    0.00
 128.00   24.00    0.00
  0.00   24.00    8.00
  8.00   24.00    8.00
 16.00   24.00    8.00
 24.00   24.00    8.00
 32.00   24.00    8.00
 40.00   24.00    8.00
 48.00   24.00    8.00
 56.00   24.00    8.00
 64.00   24.00    8.00
 72.00   24.00    8.00
 80.00   24.00    8.00
 88.00   24.00    8.00
 96.00   24.00    8.00
 104.00   24.00    8.00
 112.00   24.00    8.00
 120.00   24.00    8.00
 128.00   24.00    8.00
  0.00   24.00   16.00
  8.00   24.00   16.00
 16.00   24.00   16.00
 24.00   24.00   16.00
 32.00   24.00   16.00
 40.00   24.00   16.00
 48.00   24.00   16.00
 56.00   24.00   16.00
 64.00   24.00   16.00
 72.00   24.00   16.00
 80.00   24.00   16.00
 88.00   24.00   16.00
 96.00   24.00   16.00
 104.00   24.00   16.00
 112.00   24.00   16.00
 120.00   24.00   16.00
 128.00   24.00   16.00
  0.00   24.00   24.00
  8.00   24.00   24.00
 16.00   24.00   24.00
 24.00   24.00   24.00
 32.00   24.00   24.00
 40.00   24.00   24.00
 48.00   24.00   24.00
 56.00   24.00   24.00
 64.00   24.00   24.00
 72.00   24.00   24.00
 80.00   24.00   24.00
 88.00   24.00   24.00
 96.00   24.00   24.00
 104.00   24.00   24.00
 112.00   24.00   24.00
 120.00   24.00   24.00
 128.00   24.00   24.00
  0.00   24.00   32.00
  8.00   24.00   32.00
 16.00   24.00   32.00
 24.00   24.00   32.00
 32.00   24.00   32.00
 40.00   24.00   32.00
 48.00   24.00   32.00
 56.00   24.00   32.00
 64.00   24.00   32.00
 72.00   24.00   32.00
 80.00   24.00   32.00
 88.00   24.00   32.00
 96.00   24.00   32.00
 104.00   24.00   32.00
 112.00   24.00   32.00
 120.00   24.00   32.00
 128.00   24.00   32.00
  0.00   24.00   40.00
  8.00   24.00   40.00
 16.00   24.00   40.00
 24.00   24.00   40.00
 32.00   24.00   40.00
 40.00   24.00   40.00
 48.00   24.00   40.00
 56.00   24.00   40.00
 64.00   24.00   40.00
 72.00   24.00   40.00
 80.00   24.00   40.00
 88.00   24.00   40.00
 96.00   24.00   40.00
 104.00   24.00   40.00
 112.00   24.00   40.00
 120.00   24.00   40.00
 128.00   24.00   40.00
  0.00   24.00   48.00
  8.00   24.00   48.00
 16.00   24.00   48.00
 24.00   24.00   48.00
 32.00   24.00   48.00
 40.00   24.00   48.00
 48.00   24.00   48.00
 56.00   24.00   48.00
 64.00   24.00   48.00
 72.00   24.00   48.00
 80.00   24.00   48.00
 88.00   24.00   48.00
 96.00   24.00   48.00
 104.00   24.00   48.00
 112.00   24.00   48.00
 120.00   24.00   48.00
 128.00   24.00   48.00
  0.00   24.00   56.00
  8.00   24.00   56.00
 16.00   24.00   56.00
 24.00   24.00   56.00
 32.00   24.00   56.00
 40.00   24.00   56.00
 48.00   24.00   56.00
 56.00   24.00   56.00
 64.00   24.00   56.00
 72.00   24.00   56.00
 80.00   24.00   56.00
 88.00   24.00   56.00
 96.00   24.00   56.00
 104.00   24.00   56.00
 112.00   24.00   56.00
 120.00   24.00   56.00
 128.00   24.00   56.00
  0.00   24.00   64.00
  8.00   24.00   64.00
 16.00   24.00   64.00
 24.00   24.00   64.00
 32.00   24.00   64.00
 40.00   24.00   64.00
 48.00   24.00   64.00
 56.00   24.00   64.00
 64.00   24.00   64.00
 72.00   24.00   64.00
 80.00   24.00   64.00
 88.00   24.00   64.00
 96.00   24.00   64.00
 104.00   24.00   64.00
 112.00   24.00   64.00
 120.00   24.00   64.00
 128.00   24.00   64.00
  0.00   24.00   72.00
  8.00   24.00   72.00
 16.00   24.00   72.00
 24.00   24.00   72.00
 32.00   24.00   72.00
 40.00   24.00   72.00
 48.00   24.00   72.00
 56.00   24.00   72.00
 64.00   24.00   72.00
 72.00   24.00   72.00
 80.00   24.00   72.00
 88.00   24.00   72.00
 96.00   24.00   72.00
 104.00   24.00   72.00
 112.00   24.00   72.00
 120.00   24.00   72.00
 128.00   24.00   72.00
  0.00   24.00   80.00
  8.00   24.00   80.00
 16.00   24.00   80.00
 24.00   24.00   80.00
 32.00   24.00   80.00
 40.00   24.00   80.00
 48.00   24.00   80.00
 56.00   24.00   80.00
 64.00   24.00   80.00
 72.00   24.00   80.00
 80.00   24.00   80.00
 88.00   24.00   80.00
 96.00   24.00   80.00
 104.00   24.00   80.00
 112.00   24.00   80.00
 120.00   24.00   80.00
 128.00   24.00   80.00
  0.00   24.00   88.00
  8.00   24.00   88.00
 16.00   24.00   88.00
 24.00   24.00   88.00
 32.00   24.00   88.00
 40.00   24.00   88.00
 48.00   24.00   88.00
 56.00   24.00   88.00
 64.00   24.00   88.00
 72.00   24.00   88.00
 80.00   24.00   88.00
 88.00   24.00   88.00
 96.00   24.00   88.00
 104.00   24.00   88.00
 112.00   24.00   88.00
 120.00   24.00   88.00
 128.00   24.00   88.00
  0.00   24.00   96.00
  8.00   24.00   96.00
 16.00   24.00   96.00
 24.00   24.00   96.00
 32.00   24.00   96.00
 40.00   24.00   96.00
 48.00   24.00   96.00
 56.00   24.00   96.00
 64.00   24.00   96.00
 72.00   24.00   96.00
 80.00   24.00   96.00
 88.00   24.00   96.00
 96.00   24.00   96.00
 104.00   24.00   96.00
 112.00   24.00   96.00
 120.00   24.00   96.00
 128.00   24.00   96.00
  0.00   24.00   104.00
  8.00   24.00   104.00
 16.00   24.00   104.00
 24.00   24.00   104.00
 32.00   24.00   104.00
 40.00   24.00   104.00
 48.00   24.00   104.00
 56.00   24.00   104.00
 64.00   24.00   104.00
 72.00   24.00   104.00
 80.00   24.00   104.00
 88.00   24.00   104.00
 96.00   24.00   104.00
 104.00   24.00   104.00
 112.00   24.00   104.00
 120.00   24.00   104.00
 128.00   24.00   104.00
  0.00   24.00   112.00
  8.00   24.00   112.00
 16.00   24.00   112.00
 24.00   24.00   112.00
 32.00   24.00   112.00
 40.00   24.00   112.00
 48.00   24.00   112.00
 56.00   24.00   112.00
 64.00   24.00   112.00
 72.00   24.00   112.00
 80.00   24.00   112.00
 88.00   24.00   112.00
 96.00   24.00   112.00
 104.00   24.00   112.00
 112.00   24.00   112.00
 120.00   24.00   112.00
 128.00   24.00   112.00
  0.00   24.00   120.00
  8.00   24.00   120.00
 16.00   24.00   120.00
 24.00   24.00   120.00
 32.00   24.00   120.00
 40.00   24.00   120.00
 48.00   24.00   120.00
 56.00   24.00   120.00
 64.00   24.00   120.00
 72.00   24.00   120.00
 80.00   24.00   120.00
 88.00   24.00   120.00
 96.00   24.00   120.00
 104.00   24.00   120.00
 112.00   24.00   120.00
 120.00   24.00   120.00
 128.00   24.00   120.00
  0.00   24.00   128.00
  8.00   24.00   128.00
 16.00   24.00   128.00
 24.00   24.00   128.00
 32.00   24.00   128.00
 40.00   24.00   128.00
 48.00   24.00   128.00
 56.00   24.00   128.00
 64.00   24.00   128.00
 72.00   24.00   128.00
 80.00   24.00   128.00
 88.00   24.00   128.00
 96.00   24.00   128.00
 104.00   24.00   128.00
 112.00   24.00   128.00
 120.00   24.00   128.00
 128.00   24.00   128.00



 **Message from split_rec:
 Splitting of receivers from global to local grids finished.
 MYID= 0 	 	 no. of receivers= 0
2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:300 | 
 ------------------ MEMORY ALLOCATION --------------------------- 

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:301 | 
 **Message from main (printed by PE 0):

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:302 |  Size of local grids: NX=80 	 NY=23 	 NZ=40 

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:303 |  Each process is now trying to allocate memory for:

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:304 |  Dynamic modeling variables: 		   3.43 MB

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:305 |  Static modeling variables: 		   3.81 MB

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:306 |  Seismograms: 				   9.26 MB

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:307 |  Dynamic inversion variables: 		  22.84 MB

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:308 |  Static inversion variables: 		   3.37 MB

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:309 |  Buffer arrays for grid exchange: 	   0.55 MB

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:310 |  Network Buffer for MPI_Bsend: 		   1.17 MB

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:311 |  ------------------------------------------------ 

2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:312 |  Total memory required: 		  44.42 MB.


2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:626 |  ... memory allocation for PE 0 was successfull.


2023-08-29 14:32:02 | INFO    | ifos3d.c        | main:630 | 
 ------------------ MODEL CREATION AND OUTPUT-------------------- 

 start creation of toy-model PE 0 starts merge of 64 model files 
 writing merged model file to  ./model/toy.vp_it0 
 Copying... ... finished. 
 PE 0 starts merge of 64 model files 
 writing merged model file to  ./model/toy.vs_it0 
 Copying... ... finished. 
 PE 0 starts merge of 64 model files 
 writing merged model file to  ./model/toy.rho_it0 
 Copying... ... finished. 
2023-08-29 14:32:11 | INFO    | ifos3d.c        | main:654 | 
 ------------------ READING SOURCE PARAMETERS ------------------- 

2023-08-29 14:32:11 | INFO    | ifos3d.c        | main:661 | 
 Reading source parameters from file: input/sources.dat (IFOS source format)

2023-08-29 14:32:11 | INFO    | ifos3d.c        | main:672 |  Number of source positions specified in input/sources.dat : 12 

 Maximum frequency defined in source file: 300.00 Hz

 **Message from function source (written by PE 0):
 Number of global source positions found: 12
 x		y		z		tshift		fc		amp		stype
 3.20e+01	9.20e+01	3.20e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 3.20e+01	9.20e+01	5.28e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 3.20e+01	9.20e+01	7.44e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 3.20e+01	9.20e+01	9.60e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 6.40e+01	9.20e+01	3.20e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 6.40e+01	9.20e+01	5.28e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 6.40e+01	9.20e+01	7.44e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 6.40e+01	9.20e+01	9.60e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 9.60e+01	9.20e+01	3.20e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 9.60e+01	9.20e+01	5.28e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 9.60e+01	9.20e+01	7.44e+01	5.00e-03	3.00e+02	1.00e+00	  4.00
 9.60e+01	9.20e+01	9.60e+01	5.00e-03	3.00e+02	1.00e+00	  4.00





 **Message from checkfd (printed by PE 0):
 Minimum and maximum P-wave and S-wave velocities within subvolume: 
  MYID	 Vp_min(f=fc) 	 Vp_max(f=inf) 	 Vs_min(f=fc) 	 Vsmax(f=inf) 
 0 	  6200.00 	  6200.00 	  3600.00 	  3600.00 


 Global values for entire model: 
 Vp_max=  6200.00 m/s 	 Vs_min= 3600.00 m/s 


 ------------------ CHECK OUTPUT FILES --------------------------
 Check accessibility for seismogram files  ... 
    Check accessibility for seismogram file ./su/cal_vx.su.0.tmp... 
    Check accessibility for seismogram file ./su/cal_vy.su.0.tmp... 
    Check accessibility for seismogram file ./su/cal_vz.su.0.tmp... 


 ------------------ CHECK FOR GRID DISPERSION --------------------
 To satisfactorily limit grid dispersion the number of gridpoints 
    per minimum wavelength (of S-waves) should be 6 (better more).
 Here the minimum wavelength is assumed to be minimum model phase velocity 
    (of S-waves) at maximum frequency of the source
    devided by maximum frequency of the source.
 Maximum frequency of the source is approximately   600.00 Hz
    (= two times FC specified in the sources file)
 The minimum wavelength (of S-waves) in the following simulation will
    be 6.0000 meter.
 Thus, at the chosen FD_ORDER of 4 the recommended value for DH is 0.7212 meter 
    (8.32 gridpoints per minimum wavelength).
 You have specified DH= 0.8000 meter.

W A R N I N G   M E S S A G E: 
 Grid dispersion will influence wave propagation, choose smaller grid spacing (DH).
 

 ----------------------- CHECK FOR STABILITY ---------------------
 The following simulation is stable provided that

 	 p=cmax*DT/DH < 1/(gamma*sqrt(3)) = 0.487,

 where cmax is the maximum phase velocity at infinite frequency,
 In the current simulation cmax is  6200.00 m/s .

 DT is the timestep and DH is the grid size.

 gamma = 1.185 for spatial FD operators of order 4 .

 In this simulation the stability limit for timestep DT is 6.288700e-05 seconds .
 You have specified DT= 5.000000e-05 s.
 The simulation will be stable.
 

 --------------------- CHECK FOR INPUT ERRORS ---------------------
 Checking the time of wave propagation. 
 Checking the number of seismogram samples. 
    Number of timesteps 1200.
    Seismogram sampling rate in timesteps 1.
    Number of seismogram output samples 1200.

 Checking for receiver position(s) specified in input file.
    Global grid size in m: 128.00 (x) : 147.20 (y) : 128.00 (z) :.
    Global grid size in m(-width of abs.boundary) : 
         8.00-120.00 (x in m) :  8.00-139.20 (y in m) :  8.00-120.00 (z in m).
    Number of receiver positions in receiver file  : 289 
    Minimum receiver position coordinates :  0.00 (x) : 24.00 (y) :  0.00 (z).
    Maximum receiver position coordinates : 128.00 (x) : 24.00 (y) : 128.00 (z).
W A R N I N G   M E S S A G E: 


 Coordinate of at least one receiver location is inside the Absorbing Boundary (warning 1). 


W A R N I N G   M E S S A G E: 


 Coordinate of at least one receiver location is inside the Absorbing Boundary (warning 2). 


 ... complete, receiver position specified in input file are located within the global grid.

 Checking for source position(s) specified in source file. 
    Global grid size in m: 128.00 (x) : 147.20 (y) : 128.00 (z) :.
    Global grid size in m (-width of abs.boundary) : 
         8.00-120.00 (x in m) :  8.00-139.20 (y in m) :  8.00-120.00 (z in	m).
    Number of source positions in source file input/sources.dat. : 12.
    Minimum source position coordinates : 32.00 (x) : 92.00 (y) : 32.00 (z).
    Maximum source position coordinates : 96.00 (x) : 92.00 (y) : 96.00 (z).
 ...complete, all source position(s) specified in source file are located within the global grid.


 ----------------------- ABSORBING BOUNDARY ------------------------
 Width (FW) of absorbing frame should be at least 30 gridpoints.
 You have specified a width of 10 gridpoints.
W A R N I N G   M E S S A G E: 
 Be aware of strong artificial reflections from grid boundaries ! 

 Width (FW) of CPML-frame should be at least 20 gridpoints.
 You have specified a width of 10 gridpoints.
W A R N I N G   M E S S A G E: 
 Be aware of strong artificial reflections from grid boundaries ! 


 **Message from absorb (printed by PE 0):
 Coefficients for absorbing frame are now calculated.
 Width of dissipative frame (grid points)= 10
 Percentage of exponential damping =  9.90
 Table of coefficients 
 # 	 coeff 
 1 	 0.901 
 2 	 0.921 
 3 	 0.939 
 4 	 0.955 
 5 	 0.968 
 6 	 0.980 
 7 	 0.988 
 8 	 0.995 
 9 	 0.999 
 10 	 1.000 
2023-08-29 14:32:11 | INFO    | ifos3d.c        | main:772 | 
 *********** STARTING ITERATION NUMBER 1 ***************



 **Message from matcopy (written by PE 0):
 Copy material properties at inner boundaries ... 
 finished (real time: 0.01 s).


 **Message from av_mat (written by PE 0):
 Averaging of material parameters ... 
 finished (real time: 0.02 s).


 ********** INVERSION STAGE NR. 1 ********** 
 INV_FILE:input/workflow.dat


 itmin=15; itmax=15; 

 Number of Frequencies in Stage Nr.1: nf=5 

 finv[0]=160.00;  finv[1]=170.00;  finv[2]=180.00;  finv[3]=190.00;  finv[4]=200.00; 
2023-08-29 14:32:11 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 1 of 12  ********** 

2023-08-29 14:32:11 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 14:42:44 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 14:42:44 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 14:56:39 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 14:56:39 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 2 of 12  ********** 

2023-08-29 14:56:39 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 15:05:29 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 15:05:29 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 15:19:20 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 15:19:20 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 3 of 12  ********** 

2023-08-29 15:19:20 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 15:27:39 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 15:27:39 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 15:41:32 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 15:41:32 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 4 of 12  ********** 

2023-08-29 15:41:32 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 15:51:22 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 15:51:22 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 16:05:19 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 16:05:19 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 5 of 12  ********** 

2023-08-29 16:05:19 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 16:17:06 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 16:17:06 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 16:31:04 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 16:31:04 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 6 of 12  ********** 

2023-08-29 16:31:04 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 16:40:49 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 16:40:49 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 16:54:52 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 16:54:52 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 7 of 12  ********** 

2023-08-29 16:54:52 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 17:04:05 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 17:04:05 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 17:17:57 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 17:17:57 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 8 of 12  ********** 

2023-08-29 17:17:57 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 17:29:06 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 17:29:06 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 17:43:01 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 17:43:01 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 9 of 12  ********** 

2023-08-29 17:43:01 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 17:53:38 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 17:53:38 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 18:07:34 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 18:07:34 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 10 of 12  ********** 

2023-08-29 18:07:34 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 18:16:32 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 18:16:32 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 18:30:32 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 18:30:32 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 11 of 12  ********** 

2023-08-29 18:30:32 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 18:38:55 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 18:38:55 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 18:52:58 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 18:52:58 | INFO    | ifos3d.c        | main:816 | 
 **********   Starting simulation for shot 12 of 12  ********** 

2023-08-29 18:52:58 | INFO    | ifos3d.c        | main:856 | 
 ****************************************
 
 **************************************** 
2023-08-29 19:02:55 | INFO    | ifos3d.c        | main:1027 | 

 *********** STARTING TIME STEPPING BACK PROPAGATION ***************

2023-08-29 19:02:55 | INFO    | ifos3d.c        | main:1055 | 
 ****************************************
 
 **************************************** 
2023-08-29 19:16:52 | INFO    | ifos3d.c        | main:1131 | 
 End backpropagation 

2023-08-29 19:16:52 | INFO    | ifos3d.c        | main:1183 | 
 raw Gradient: 


 Gradient preconditioning
 PE 0 starts merge of 64 model files 
 writing merged model file to  ./grad/grad.vp_160.00Hz_it1001 
 Copying... ... finished. 
 PE 0 starts merge of 64 model files 
 writing merged model file to  ./grad/grad.vs_160.00Hz_it1001 
 Copying... ... finished. 
 PE 0 starts merge of 64 model files 
 writing merged model file to  ./grad/grad.rho_160.00Hz_it1001 
 Copying... ... finished. 

 Calculate conjugate gradient 2023-08-29 19:17:12 | INFO    | ifos3d.c        | main:1207 | 

 *********** STEPLENGTH CALCULATION ITERATION 1 *********** 

2023-08-29 19:17:12 | INFO    | ifos3d.c        | main:1214 | 

 1. test steplength: step[1]=2.00e-02 

2023-08-29 19:17:12 | INFO    | ifos3d.c        | main:1215 |  ------------------------------------ 


 Message from modelupdate.c 
 Maximum values in current model:
 rhomax=2800.00, vpmax=6200.00, vsmax=3600.00 


 **Message from matcopy (written by PE 0):
 Copy material properties at inner boundaries ... 
 finished (real time: 0.12 s).


 **Message from av_mat (written by PE 0):
 Averaging of material parameters ... 
 finished (real time: 0.02 s).
2023-08-29 19:17:12 | INFO    | ifos3d.c        | main:1229 | 
 **********  Starting simulation for shot 1 of 12  ********** 

2023-08-29 19:17:12 | INFO    | ifos3d.c        | main:1251 | 
 ****************************************
 
 ---###------------------------------------------------------> main,  1261,  MYID: 0
---###------------------------------------------------------> main,  1261,  MYID: 1
Message from PE 1
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 1
[31m[1m  SWCH Error: MYID = 1(vn21510, CG1): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 24
Message from PE 24
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 24
---###------------------------------------------------------> main,  1261,  MYID: 27
Message from PE 27
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 27
[31m[1m  SWCH Error: MYID = 27(vn21514, CG3): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 48
Message from PE 48
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 48
[31m[1m  SWCH Error: MYID = 48(vn21518, CG0): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 49
Message from PE 49
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 49
[31m[1m  SWCH Error: MYID = 49(vn21518, CG1): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 53
Message from PE 53
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 53
[31m[1m  SWCH Error: MYID = 53(vn21518, CG5): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 60
Message from PE 60
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
---###------------------------------------------------------> main,  1261,  MYID: 61
Message from PE 61
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 61
[31m[1m  SWCH Error: MYID = 61(vn21520, CG1): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 62
Message from PE 62
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 62
[31m[1m  SWCH Error: MYID = 62(vn21520, CG2): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 63
Message from PE 63
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 63
[31m[1m  SWCH Error: MYID = 63(vn21520, CG3): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 2
Message from PE 2
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 2
[31m[1m  SWCH Error: MYID = 2(vn21510, CG2): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 3
Message from PE 3
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 3
[31m[1m  SWCH Error: MYID = 3(vn21510, CG3): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 4
Message from PE 4
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 4
[31m[1m  SWCH Error: MYID = 4(vn21510, CG4): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 5
Message from PE 5
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 5
[31m[1m  SWCH Error: MYID = 5(vn21510, CG5): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
Message from PE 0
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 0
[31m[1m  SWCH Error: MYID = 0(vn21510, CG0): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
[31m[1m  SWCH Error: MYID = 24(vn21514, CG0): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 50
Message from PE 50
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 50
[31m[1m  SWCH Error: MYID = 50(vn21518, CG2): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 51
Message from PE 51
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 51
[31m[1m  SWCH Error: MYID = 51(vn21518, CG3): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 52
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 60
[31m[1m  SWCH Error: MYID = 60(vn21520, CG0): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 25
---###------------------------------------------------------> main,  1261,  MYID: 26
Message from PE 26
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 26
[31m[1m  SWCH Error: MYID = 26(vn21514, CG2): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 28
Message from PE 28
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 28
[31m[1m  SWCH Error: MYID = 28(vn21514, CG4): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
---###------------------------------------------------------> main,  1261,  MYID: 29
Message from PE 29
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 29
[31m[1m  SWCH Error: MYID = 29(vn21514, CG5): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
Message from PE 52
Message from PE 25
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 25
[31m[1m  SWCH Error: MYID = 25(vn21514, CG1): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
R U N - T I M E  E R R O R: 
 Simulation is unstable !
...now exiting to system.
application called MPI_Abort(MPI_COMM_WORLD, 1) - process 52
[31m[1m  SWCH Error: MYID = 52(vn21518, CG4): calling MPID_Abort!!!: <MPID_Abort()@src/mpid/ch3/src/mpid_abort.c:96>. [0m
